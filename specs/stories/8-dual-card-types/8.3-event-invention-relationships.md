### User Story 8.3

**Number:** `8.3`
**ID:** `BA-US-event-invention-relationships`
**Role:** `player`
**Story:** `As a player, I want to see how historical events influenced inventions and how inventions influenced events so that I understand the cause-and-effect relationships in history, deepening my learning and appreciation of how history and technology are interconnected.`

**Context / Background:**
- This story builds on 8.1 (data model) and 8.2 (visual distinction) by adding relationship tracking
- Understanding relationships is key educational value: history and technology are not isolated - they influence each other
- Examples of relationships:
  - Event influences Invention: World War II (event) accelerated computer development (invention)
  - Invention influences Event: The printing press (invention) enabled the Protestant Reformation (event)
  - Bidirectional: The telescope (invention) led to astronomical discoveries (events), which inspired more telescope improvements
- This creates a narrative web that helps kids understand historical context and causation
- Relationships should be displayed on card details and potentially in the album view
- For MVP, relationships are predefined by content authors (not player-discovered)
- Educational value: Teaches critical thinking about cause and effect, systems thinking, and historical context

**Functional Requirements:**
1. Extend the Event interface to include relationship metadata (influenced by, led to, enabled, etc.)
2. Define relationship data structure: card ID, relationship type, direction
3. Populate sample events with relationship data (e.g., Printing Press "enabled" Protestant Reformation)
4. Display relationships on card detail view (e.g., "This invention led to..." section)
5. Show relationship indicators visually (icons, connecting lines, or badges)
6. Allow navigation from one card to related cards (clickable relationship links)
7. Support bidirectional relationships (if A influenced B, show B influenced by A)
8. Filter or highlight related cards when viewing a card (optional)

**Non-Functional / UX Requirements:**
- Relationship descriptions must be kid-friendly and concise (1 sentence max)
- Relationship display should not clutter card UI (collapsible section or tab)
- Navigation between related cards must be smooth and intuitive
- Relationships should enhance learning without overwhelming the player
- Must work on mobile (touch-friendly relationship links)
- Performance: loading relationships should not slow down card display
- Relationship data should be cacheable for performance

**Data & State:**
- Inputs:
  - Card data with cardType field
  - Relationship metadata: { relatedCardId, relationshipType, description }
  - Existing relatedEventIds field in EventContent (can be extended)
- Outputs:
  - Relationship section displayed on card details
  - Visual indicators for relationships (icons, badges)
  - Clickable links to navigate to related cards
  - Summary of relationships (e.g., "Influenced 3 events, enabled by 2 inventions")
- State rules:
  - Relationships are stored bidirectionally (if A -> B, then B <- A is implied or stored)
  - Relationship type can be: "influenced", "enabled", "led-to", "accelerated", "inspired", "required-by"
  - A card can have multiple relationships of different types
  - Relationships can connect events to events, inventions to inventions, or cross-type
  - Relationships are defined at data creation time (not dynamically during gameplay)

**Validation & Edge Cases:**
- Card references non-existent related card: skip display of that relationship
- Card has no relationships: show message "Explore more to discover connections!" or hide section
- Circular relationships (A -> B -> A): handle gracefully, don't create infinite loops
- Relationship type is undefined or invalid: default to generic "related to" label
- Player clicks relationship link to card not yet unlocked: show preview or "unlock to learn more" message
- Mobile view with many relationships: use scrollable list or collapsible sections
- Card has both Event and Invention relationships: group by type in display
- Relationship description is missing: use generic text based on relationship type
- Bidirectional relationship data is inconsistent (A says influenced B, but B doesn't mention A): display what's available

**Assumptions:**
- The existing EventContent.relatedEventIds field can be extended to include relationship metadata
- Relationship types are limited to a small set for MVP: "influenced", "enabled", "led-to", "inspired"
- Relationship descriptions are short text snippets (e.g., "The Printing Press enabled the spread of Reformation ideas")
- Sample events will have at least 3-5 relationships defined across the dataset
- Relationships are manually curated by content authors (not algorithmically generated)
- For MVP, complex relationship types (e.g., "prevented by", "competed with") are out of scope
- Example relationships to implement:
  - Printing Press (invention) -> Protestant Reformation (could add as new event or relate to existing events)
  - Steam Engine (invention) -> Industrial Revolution (could add as event or concept)
  - World War II (could add as event) -> Internet (invention) - military research led to ARPANET
  - Telescope (invention) -> Discovery of Jupiter's moons (mentioned in story, could formalize)
  - Wheel (invention) -> Great Pyramid building (related in existing sample data)
- Relationship display is a section on card details page, not a separate view
- Clicking a relationship link navigates to the related card (same as clicking a timeline dot)

**Out of Scope (for this story):**
- Visual timeline graph showing relationship connections (network diagram)
- Player-identified relationships (player creates connections during gameplay)
- Relationship strength or weighting (e.g., "strongly influenced" vs "weakly influenced")
- Temporal relationship constraints (e.g., A must come before B chronologically)
- Achievement or reward for discovering relationships (could be future story)
- Relationship quizzes or mini-games (e.g., "match the invention to the event it enabled")
- Filtering timeline by relationship type (e.g., "show only cards that enabled other cards")
- Exporting relationship data or visualizations
- Dynamic relationship discovery based on player progress
- Social features (sharing interesting relationships with friends)

**Acceptance Criteria (Gherkin-style):**
- Given I view an Invention card with relationships, when I open the card details, then I see a "Related Events" section listing events influenced by this invention
- Given I view an Event card with relationships, when I open the card details, then I see a "Related Inventions" section listing inventions that influenced or were influenced by this event
- Given a card has multiple relationships, when I view the relationships section, then relationships are grouped by type (influenced, enabled, etc.)
- Given I see a relationship in the card details, when I click on the related card link, then I navigate to that card's detail view
- Given I view a card with no relationships, when I open the card details, then the relationships section is hidden or shows "No connections yet"
- Given a relationship references a card I haven't unlocked, when I click the link, then I see a preview or message indicating the card is locked
- Given I view relationships on mobile, when the list is long, then I can scroll to see all relationships without UI breaking
- Given a card has relationships to both events and inventions, when I view the section, then I see clear grouping (e.g., "Events influenced" and "Inventions inspired")
- Given I view The Printing Press card, when I check relationships, then I see at least one event it enabled or influenced (based on sample data)
- Given I view The Internet card, when I check relationships, then I see at least one event that led to its creation (e.g., military research, ARPANET)
