### User Story 7.4

**Number:** `7.4`
**ID:** `BA-US-card-mastery-tracking`
**Role:** `player`
**Story:** `As a player, I want to see which cards I have mastered (unlocked all elements) and track my overall mastery progress across all cards so that I have long-term collection goals and can feel proud of my achievements.`

**Context / Background:**
- "Mastering" a card means unlocking all album elements for that card
- This story adds visual indicators of mastery on individual cards and a global progress view
- Mastery creates a completionist goal that motivates deep engagement with each historical event
- Players should be able to quickly identify which cards are mastered and which are in progress
- This feature supports long-term retention and provides a sense of accomplishment
- Educational value: Mastery requires thorough exploration and learning about each event
- Fun factor: Badges, stars, or visual flair make mastery feel special and rewarding

**Functional Requirements:**
1. Calculate mastery status for each card (unlocked elements / total elements = 100%)
2. Display mastery badge or indicator on cards that have been fully mastered
3. Show partial progress on cards that are partially unlocked (e.g., "5/12" or progress bar)
4. Provide a global view or summary of overall mastery progress across all cards
5. Update mastery status in real-time when the last element is unlocked
6. Show celebratory feedback when a player achieves mastery on a card
7. Persist mastery status so it's visible across sessions

**Non-Functional / UX Requirements:**
- Mastery indicators must be clear and visually distinct at a glance (star, checkmark, gold border, etc.)
- Partial progress should be visible but not overwhelming (small progress bar or count)
- Mastery celebration (when unlocking the last element) should be more prominent than regular unlocks
- Global mastery view should be easy to access (e.g., from header or settings)
- Must work smoothly on desktop and mobile layouts
- Mastery calculations should be efficient (no lag when loading many cards)
- Visual style should be kid-friendly and exciting (not corporate or bland)

**Data & State:**
- Inputs:
  - Player unlock data for all cards
  - Total element counts for each card
  - Current session's active cards
- Outputs:
  - Mastery status per card (boolean: mastered or not)
  - Progress percentage per card (0-100%)
  - Global mastery count (e.g., "3 out of 15 cards mastered")
- State rules:
  - A card is mastered only when 100% of elements are unlocked
  - Mastery status is calculated dynamically from unlock data
  - Mastery cannot be lost once achieved (permanent)
  - Global mastery is the sum of all mastered cards across all events

**Validation & Edge Cases:**
- Card has no album elements: cannot be mastered, exclude from mastery counts or mark as N/A
- Player has not unlocked any elements for a card: show 0% or "Not started"
- All cards in the game are mastered: show special congratulations message
- New cards are added to the game after player has mastered existing ones: global mastery percentage adjusts
- Player achieves mastery while viewing the album page: immediate celebration and visual update
- Player achieves mastery while viewing a different card: notification appears, card indicator updates
- Network failure when mastery is achieved: status is saved locally and synced later
- Player views mastery status on another device: data syncs correctly across devices

**Assumptions:**
- Mastery is a simple all-or-nothing status (no partial mastery tiers like bronze/silver/gold)
- Mastery indicators are displayed on the event card itself (e.g., in card header or corner)
- Global mastery view is a separate page or modal accessible from the main UI
- Mastery status is derived from unlock data (no separate mastery flag in database)
- Celebration for mastery uses the same notification system as unlocks, but with enhanced visuals
- For MVP, mastery tracking is per-player and not shared across sessions or players
- Event cards remain accessible even after mastery (players can revisit mastered content)

**Out of Scope (for this story):**
- Mastery rewards beyond visual indicators (e.g., unlocking new cards or game modes)
- Leaderboards or social comparison of mastery progress
- Time-based mastery challenges (e.g., "master 3 cards this week")
- Mastery tiers or levels (e.g., bronze, silver, gold mastery)
- Export or sharing mastery achievements
- Detailed statistics on time to mastery or fastest mastery
- Resetting mastery or un-mastering cards
- Group or team mastery in multiplayer mode

**Acceptance Criteria (Gherkin-style):**
- Given I have unlocked all elements for a card, when I view that card, then I see a mastery indicator (badge, star, or border)
- Given I have partially unlocked elements for a card, when I view the card, then I see partial progress (e.g., "5/12" or small progress bar)
- Given I have not started unlocking a card, when I view the card, then I see no progress or "0/12"
- Given I unlock the last element for a card, when the unlock happens, then I see a special mastery celebration (more prominent than regular unlock notification)
- Given I have mastered some cards, when I view the global mastery summary, then I see how many cards I've mastered out of the total (e.g., "3/15 cards mastered")
- Given I view the timeline or card list, when I look at the cards, then mastered cards are visually distinct from non-mastered cards
- Given I achieve mastery on a card, when I refresh the page, then the mastery indicator remains visible
- Given new cards are added to the game, when I check my global mastery, then the total count updates to include the new cards
