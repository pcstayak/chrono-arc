### User Story 6.5

**Number:** `6.5`
**ID:** `BA-US-timeline-visual-attack-indicators`
**Role:** `player`
**Story:** `As a player, I want events that are under attack to be visually highlighted on the timeline so that I can immediately identify which events need my attention.`

**Context / Background:**
- When events are attacked by time bandits, players need a clear visual signal on the timeline to draw their attention
- The timeline is the primary navigation interface for the game, showing all historical events in chronological order
- Currently, there is no visual distinction between safe events and events under attack
- This story adds special visual indicators to timeline points when their corresponding events are in "attacked" status
- The visual treatment must be noticeable but kid-friendly (not scary or anxiety-inducing)
- Educational goal: Help players prioritize which events to defend, teaching time management and consequence awareness
- Game goal: Create urgency and visual interest, making the attack mechanic more engaging

**Functional Requirements:**
1. Detect when an event's security status changes to "attacked"
2. Apply a special visual treatment to the event's point on the timeline when status is "attacked"
3. Remove the special visual treatment when the event is no longer "attacked" (defended or lost)
4. Ensure the visual indicator is visible at all timeline zoom levels (if zoom exists)
5. Make the indicator noticeable but not overwhelming (should not dominate the entire timeline)
6. Visual treatment options to consider:
   - Pulsing or animated border around the timeline point
   - Warning icon overlay on the event point (e.g., exclamation mark, shield icon)
   - Color change (red or orange to indicate danger)
   - Glowing effect around the point
   - Subtle shake or wobble animation
7. The indicator should persist until the player resolves the attack (by defending or losing the event)
8. Multiple attacked events should each have their own indicator (not just the first one)

**Non-Functional / UX Requirements:**
- Visual indicator must be noticeable within 1-2 seconds of viewing the timeline
- Animation (if used) should be smooth and not cause performance issues (60fps target)
- Animation should loop or pulse continuously until attack is resolved
- Color choices must be accessible (consider color-blind users, ensure sufficient contrast)
- Visual treatment should work on both desktop and mobile/tablet screens
- Indicator should not obscure the event's name or other important information
- Should feel urgent but not scary for kids aged 7-12 (avoid harsh red flashing, skull icons, etc.)
- Multiple attacked events should remain individually distinguishable on the timeline
- Animation duration should be reasonable (e.g., 1-2 second pulse cycle, not too fast or slow)

**Data & State:**
- Inputs:
  - Event ID
  - Event security status (safe / threatened / attacked / defended / corrupted)
  - Timeline data structure (list of events with positions)
- Outputs:
  - Visual styling for each timeline point based on status
  - CSS classes or inline styles applied to timeline elements
  - Animation state (running/paused) for each point
- State rules:
  - Only events with status "attacked" receive the special visual treatment
  - Status changes trigger immediate update to timeline visuals (reactive)
  - Visual treatment is removed when status changes from "attacked" to any other state
  - Timeline re-renders or updates when any event's status changes

**Validation & Edge Cases:**
- Event is attacked while timeline is not visible: indicator should appear when timeline is viewed
- Multiple events attacked simultaneously: each should have its own indicator, all visible at once
- Event changes from "attacked" to "defended" mid-animation: animation should stop immediately
- Event changes from "attacked" to "corrupted/lost" mid-animation: animation should stop and apply different styling (covered in story 6.6)
- Timeline is zoomed in/out (if zoom feature exists): indicator should scale appropriately
- Very small screen (mobile): indicator should still be visible without overlapping too much
- Player is viewing the attacked event's card: timeline indicator should still be visible in background/navigation
- Browser does not support CSS animations: fall back to static visual indicator (color change only)
- Rapid status changes (attacked -> safe -> attacked): ensure smooth transition without flicker

**Assumptions:**
- The timeline component can access each event's current security status from game state
- Timeline points are rendered as individual DOM elements that can be styled individually
- The timeline UI supports dynamic CSS class changes or style updates
- CSS animations or JavaScript animations can be applied to timeline points
- The game state updates are reactive and trigger timeline re-renders automatically
- There is a defined visual design system (colors, icons) that can be extended for this feature
- Timeline points have sufficient size to accommodate visual indicators (or can expand slightly)
- The timeline is visible while the player is interacting with event cards (or accessible via navigation)

**Out of Scope (for this story):**
- Visual indicators for other statuses (threatened, corrupted, defended) beyond the basic color coding
- Audio cues or sound effects when an attack occurs
- Notification system or pop-up alerts for attacks
- Filtering or sorting timeline to show only attacked events
- Count or badge showing total number of events under attack
- Animation or transition when an event becomes attacked (initial state change)
- Detailed tooltip explaining why an event is under attack
- Admin or debug mode to manually trigger attack visuals for testing
- Customizable visual themes or player-selected indicator styles
- Visual indicators on other UI elements (map view, event list, etc.) beyond the timeline

**Acceptance Criteria (Gherkin-style):**
- Given an event has security status "attacked", when I view the timeline, then that event's point has a special visual indicator (pulsing border, warning icon, or color change)
- Given an event has security status "safe" or "threatened", when I view the timeline, then that event's point has no attack indicator
- Given an event changes from "safe" to "attacked", when I am viewing the timeline, then the visual indicator appears on that event's point without requiring a page refresh
- Given an event changes from "attacked" to "defended", when I am viewing the timeline, then the attack indicator is removed from that event's point immediately
- Given multiple events are under attack, when I view the timeline, then each attacked event has its own visible indicator
- Given I am on a mobile device, when I view the timeline with attacked events, then the visual indicators are clearly visible and do not overlap illegibly
- Given an event is under attack, when I view the timeline at different zoom levels (if applicable), then the indicator remains visible and appropriately scaled
- Given an event is under attack, when I view the timeline, then the indicator does not obscure the event's name or make it unreadable
- Given I am a color-blind user, when I view the timeline with attacked events, then I can still distinguish attacked events through shape/icon/animation (not color alone)
- Given the visual indicator uses animation, when I view the timeline, then the animation runs smoothly without causing lag or performance issues
